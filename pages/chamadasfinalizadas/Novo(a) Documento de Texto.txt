<?php
require "conexao.php";

// valida o ID
if (!isset($_GET['id']) || !is_numeric($_GET['id'])) {
    die("Chamada inválida.");
}

$id = (int) $_GET['id'];

$sql = "SELECT * FROM chamadas_finalizadas WHERE chamada_id = $id LIMIT 1";
$result = $conexao->query($sql);

if (!$result || $result->num_rows === 0) {
    die("Registro não encontrado.");
}

$chamada = $result->fetch_assoc();
?>

<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Relatório da Chamada #<?= $chamada['chamada_id'] ?></title>

<style>
body{
  font-family: Arial, Helvetica, sans-serif;
  background:#f4f6f8;
}

.container{
  max-width: 1000px;
  margin: 20px auto;
  background:#fff;
  padding:20px;
  border-radius:12px;
}

h1{
  margin-top:0;
}

table{
  width:100%;
  border-collapse: collapse;
}

td{
  padding:10px;
  border-bottom:1px solid #e5e7eb;
}

td:first-child{
  font-weight:bold;
  width:35%;
}
</style>

</head>
<body>

<div class="container">

<h1>Relatório — Chamada #<?= $chamada['chamada_id'] ?></h1>

<table>

<?php foreach ($chamada as $campo => $valor): ?>
<tr>
  <td><?= htmlspecialchars($campo) ?></td>
  <td><?= nl2br(htmlspecialchars($valor)) ?></td>
</tr>
<?php endforeach; ?>

</table>

<p>
  <a href="index.php">← Voltar</a>
</p>

</div>

</body>
</html>
